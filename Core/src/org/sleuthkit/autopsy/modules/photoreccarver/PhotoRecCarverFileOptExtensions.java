/*
 * Autopsy Forensic Browser
 *
 * Copyright 2020 Basis Technology Corp.
 * Contact: carrier <at> sleuthkit <dot> org
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.sleuthkit.autopsy.modules.photoreccarver;

import java.util.Arrays;
import java.util.HashSet;
import java.util.Set;

/**
 * Specifies what extensions can be used for the "fileopt" option of photorec,
 * which allows certain extensions to be included or excluded.
 */
final class PhotoRecCarverFileOptExtensions {

    /**
     * Returns true if the extension provided in the string can be used with
     * photorec.
     *
     * @param extension The extension (i.e. 'exe').
     *
     * @return True if the extension can be used with photorec.
     */
    static boolean isValidExtension(String extension) {
        return KNOWN_EXTENSIONS.contains(extension);
    }

    // This was generated by photorec.  It can be generated by photorec by
    // launching photorec_win with no arguments, go to "Proceed", go to 
    // "File Opt" and press 'b'.  This should generate a photorec.cfg file in 
    // the working directory with all the extensions.
    private static final Set<String> KNOWN_EXTENSIONS = new HashSet<String>(Arrays.asList(
            "1cd",
            "3dm",
            "7z",
            "DB",
            "a",
            "abr",
            "acb",
            "accdb",
            "ace",
            "ab",
            "ado",
            "afdesign",
            "ahn",
            "aif",
            "all",
            "als",
            "amd",
            "amr",
            "apa",
            "ape",
            "apple",
            "ari",
            "arj",
            "asf",
            "asl",
            "asm",
            "atd",
            "au",
            "axp",
            "axx",
            "bac",
            "bdm",
            "db",
            "bim",
            "bin",
            "binvox",
            "bkf",
            "blend",
            "bmp",
            "bpg",
            "bvr",
            "bz2",
            "c4d",
            "cab",
            "caf",
            "cam",
            "catdrawing",
            "cdt",
            "che",
            "chm",
            "class",
            "comicdoc",
            "cp_",
            "cow",
            "cpi",
            "crw",
            "csh",
            "ctg",
            "cwk",
            "d2s",
            "dad",
            "dar",
            "dat",
            "dbf",
            "dbn",
            "dcm",
            "ddf",
            "dex",
            "diskimage",
            "fat",
            "djv",
            "dmp",
            "drw",
            "doc",
            "dpx",
            "ds2",
            "DS_Store",
            "dsc",
            "dss",
            "dst",
            "dta",
            "dump",
            "dv",
            "dvi",
            "dvr",
            "dwg",
            "dxf",
            "e01",
            "eCryptfs",
            "edb",
            "elf",
            "emf",
            "ess",
            "evt",
            "evtx",
            "exe",
            "exs",
            "ext",
            "ext",
            "fat",
            "fbf",
            "fbk",
            "fcp",
            "fcs",
            "fdb",
            "fds",
            "fh10",
            "fh5",
            "sparseimage",
            "fits",
            "fit",
            "flac",
            "flp",
            "flv",
            "fm",
            "fob",
            "fos",
            "fp5",
            "fp7",
            "freeway",
            "frm",
            "fs",
            "fwd",
            "gam",
            "gct",
            "gho",
            "gi",
            "gif",
            "gm*",
            "gp2",
            "gp5",
            "gpg",
            "gpx",
            "gsm",
            "gz",
            "hdf",
            "hdr",
            "hds",
            "hfsp",
            "hm",
            "hr9",
            "http",
            "ibd",
            "icc",
            "icns",
            "ico",
            "idx",
            "ifo",
            "imb",
            "indd",
            "info",
            "iso",
            "it",
            "itu",
            "jks",
            "jpg",
            "jsonlz4",
            "kdb",
            "kdbx",
            "key",
            "ldf",
            "lit",
            "logic",
            "lnk",
            "lso",
            "luks",
            "lxo",
            "lzh",
            "lzo",
            "m2ts",
            "mat",
            "max",
            "mb",
            "mcd",
            "mdb",
            "mdf",
            "mfa",
            "mfg",
            "mft",
            "mid",
            "mig",
            "mk5",
            "mkv",
            "mlv",
            "mobi",
            "mov/mdat",
            "mov",
            "mp3",
            "mpg",
            "mpl",
            "mrw",
            "msa",
            "mus",
            "myo",
            "MYI",
            "mxf",
            "nd2",
            "nds",
            "nes",
            "njx",
            "nk2",
            "nsf",
            "oci",
            "ogg",
            "one",
            "orf",
            "paf",
            "pap",
            "par2",
            "pcap",
            "pcb",
            "pct",
            "pcx",
            "pdb",
            "pdf",
            "pds",
            "pf",
            "pfx",
            "dump",
            "plist",
            "plr",
            "plt",
            "png",
            "pnm",
            "prc",
            "prd",
            "prt",
            "ps",
            "psb",
            "psd",
            "psf",
            "psp",
            "pst",
            "ptb",
            "ptf",
            "pyc",
            "pzf",
            "pzh",
            "qbb",
            "qdf",
            "qkt",
            "qxd",
            "r3d",
            "ra",
            "raf",
            "rar",
            "raw",
            "rdc",
            "reg",
            "res",
            "rfp",
            "riff",
            "rlv",
            "rm",
            "rns",
            "rpm",
            "rw2",
            "rx2",
            "save",
            "ses",
            "sgcta",
            "shn",
            "sib",
            "sit",
            "skd",
            "skp",
            "snag",
            "snz",
            "sp3",
            "spe",
            "spf",
            "sav",
            "sqlite",
            "sqm",
            "steuer2014",
            "stl",
            "studio",
            "sit",
            "swf",
            "tar",
            "tax",
            "tg",
            "tib",
            "tif",
            "TiVo",
            "torrent",
            "tph",
            "tpl",
            "ts",
            "ttf",
            "tx?",
            "txt",
            "tz",
            "v2i",
            "vault",
            "vdj",
            "vfb",
            "vdi",
            "veg",
            "vib",
            "vmdk",
            "vmg",
            "wallet",
            "wdp",
            "wee",
            "wim",
            "win",
            "wks",
            "wld",
            "wmf",
            "wnk",
            "woff",
            "wpb",
            "wpd",
            "wtv",
            "wv",
            "x3f",
            "x3i",
            "x4a",
            "xar",
            "xcf",
            "xfi",
            "xfs",
            "xm",
            "xml",
            "xsv",
            "xpt",
            "xv",
            "xz",
            "z2d",
            "zcode",
            "zip",
            "zpr"));

    private PhotoRecCarverFileOptExtensions() {
    }
}
